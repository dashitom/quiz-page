:root {
  --color-dark: #002060;
  --color-light: #3399FF;
  --color-bg-top: #3399FF;
  --color-bg-bottom: #0056b3;
  --color-shadow: #555555;
  --color-text: white;
  --color-mikiri: #B8860B;
  --color-renda: #953735;

  --color-dark-2: #005020;      /* 深いグリーン系の濃色 */
  --color-light-2: #33cc66;     /* 明るい黄緑寄りのライトカラー */
  --color-bg-top-2: #33cc66;    /* 上部グラデの明るめグリーン */
  --color-bg-bottom-2: #007a3d; /* 下部グラデの締め色 */
  /* -3 Orange */
  --color-dark-3: #7a3d00;
  --color-light-3: #ffa64d;
  --color-bg-top-3: #ffb366;
  --color-bg-bottom-3: #cc5c00;
  /* -4 Red */
  --color-dark-4: #7a0010;
  --color-light-4: #ff6675;
  --color-bg-top-4: #ff808c;
  --color-bg-bottom-4: #b3001f;

  
  --pastel-blue:   #6ec5ff;
  --pastel-green:  #7ff2a4;
  --pastel-yellow: #fff06a;
  --pastel-orange: #ffb56a;
  --pastel-red:    #ff7f7f;
}

.change-color-target {
  transition:
    color 2s linear,
    background-color 2s linear,
    border-color 2s linear,
    fill 2s linear,
    stroke 2s linear;
}

/* === 共通設定 === */
html,body{
  margin:0;padding:0;height:100%;
  background:linear-gradient(to bottom,var(--color-bg-top),var(--color-bg-bottom));
  font-family:'Helvetica Neue',sans-serif;overflow:hidden;
}

body .change-color-target {
    transition:background-color 2s linear;
}

/* 文字選択・画像保存などを禁止 */
body {
  -webkit-user-select: none; /* 文字選択禁止 */
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-touch-callout: none; /* 画像長押しメニュー無効 */
}

/* 画像にも適用 */
img {
  pointer-events: none; /* ドラッグや右クリック防止 */
}

* {
  touch-action: manipulation; /* ダブルタップ拡大防止 */
  -webkit-user-select: none; /* テキスト選択も防ぐ場合 */
  -webkit-tap-highlight-color: transparent; /* iOSのタップハイライト除去 */
}
/* 背景パターン定義 */
body {
  position:relative;
  inset:0;
  background-image: 
    repeating-linear-gradient(90deg, rgba(255,255,255,0.3) 0 1px, transparent 1px 40px),
    repeating-linear-gradient(0deg, rgba(255,255,255,0.3) 0 1px, transparent 1px 40px);
  background-size: 40px 40px, 40px 40px, 200px 200px, 300px 300px;
  animation: movePattern 50s linear infinite;
  mask-repeat: no-repeat;
  mask-position: center;
  mask-size: contain;
  min-height: 100vh;
  padding-top: env(safe-area-inset-top);
}

body {
  display: flex;
  justify-content: center; /* 横方向中央 */
  align-items: center;     /* 縦方向中央 */
  height: 100vh;
  width: 100vw;
  margin: 0; /* 不要な余白を除去 */
}


body::before {
  content:'';
  position:absolute;
  inset:0;
  top:0;
  left:0;
  width:100%;
  height:env(safe-area-inset-top);
  background:#3399FF; /* ステータスバーと同じ青 */
  z-index:9999;
}

/* 背景を右下→右上へ */
@keyframes movePattern {
  from { background-position: 100% 100%; }
  to   { background-position: 0 0; }
}

/* === 初期確認画面 === */
#first-confirm{
  position:fixed;
  width:80vw;
  height:80vh;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  z-index:3000;
  color:white;
  background:rgba(255,255,255,0.15);
  border:1px solid rgba(255,255,255,0.6);
  border-radius:8px;
  padding:1.2em;
  font-size:1rem;
  line-height:1.6;
  box-shadow:0 3px 6px rgba(0,0,0,0.15);

  opacity: 0;
  transform: translateY(20px);
  transition: transform 0.8s ease, opacity 0.8s ease;
}

#first-confirm button {
    width: 50vw;
    height: 10vh;
    margin: 15px;
    padding: 5px;
    font-size: 1.5rem;
    border-radius: 10px;
}

#first-confirm #back{
    height: 7vh;
    font-size: 1.2rem;
    border: 5px solid var(--color-dark);
}

/* === クイズコンテナ === */
.container{
  position: relative;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  height:95vh;
  width: 100%;
  max-width:60vh;
  margin: 5vh 5vw;
  box-sizing:border-box;
}

/* === ステージ情報エリア === */
.stage-info {
  position: relative; 
  margin: 0 auto 2vh; 
  display: flex;
  align-items: center;
  line-height: 1;
  justify-content: space-between;
  width: calc(100% - 4vh);
  max-width: 500px;
  background: rgba(0, 0, 0, 0.2);
  color: white;
  border-radius: 28px;
  padding: 0.5rem 1rem;
  font-weight: bold;
  font-size: 1rem;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  z-index: 1500;
  backdrop-filter: blur(3px);
}

.stage-right {
  flex: 1;
  text-align: center;
  text-shadow:
    0 0 4px rgba(100,180,255,0.7),
    0 0 8px rgba(100,180,255,0.4),
    0 0 12px rgba(100,180,255,0.2);
  display: flex;
  align-items: center;
  color: #fff;
  font-weight: 600;
  justify-content: center; /* ← 中央寄せで一体感を出す */
  gap: 0.4rem;              /* ← 適度な間隔 */
  min-width: 6.5em;         /* ← 幅を固定（4桁＋余白分） */
}

.stage-left {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  text-shadow:
    -2px -2px 0 var(--color-dark),
     2px -2px 0 var(--color-dark),
    -2px  2px 0 var(--color-dark),
     2px  2px 0 var(--color-dark),
    -2px  0   0 var(--color-dark),
     2px  0   0 var(--color-dark),
     0   -2px 0 var(--color-dark),
     0    2px 0 var(--color-dark);
}

.stage-left, .stage-right {
  flex: 0 0 auto;
  margin: 0 0.3rem;
  align-items: center;
  height: 100%;
}

.stage-center {
  flex: 1; display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 0.2rem;
  transform: translateY(1px);
}

.stage-progress {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  height: 12px;
  background: var(--color-dark);
  border-radius: 0px;
  padding: 2px;
  gap: 2px;
}

.stage-progress-segment {
  flex: 1;
  height: 100%;
  background: rgba(255,255,255,0.2);
  border-radius: 0px;
  transition: background 0.3s;
}

.stage-progress-segment.filled {
  background: var(--color-light);
}

.score-label {
  transform: translateY(2px);
  font-size: 0.85rem;
  letter-spacing: 0.5px;
}

.score-value {
  transform: translateY(1px);
  font-size: 1.2rem;
  text-align: right;
  transition: transform 0.2s ease, text-shadow 0.2s ease;
}

.score-value.bump {
  transform: scale(1.2);
  text-shadow:
    0 0 8px rgba(255,255,255,0.9),
    0 0 16px rgba(255,255,255,0.8),
    0 0 28px rgba(255,255,255,0.6);
}

/* === クイズジャンルヘッダー === */
.quiz-header{
  margin-left:-5vw;
  background:var(--color-dark);
  color:var(--color-text);
  font-weight:bold;
  font-size:1.2rem;
  border-radius:0 20px 20px 0;
  padding:0.3rem 1.5rem;
  width:max-content;
}

/* === 問題エリア === */
.question-box{
  flex:3;
  height: 35vh;
  background:white;
  border-radius:10px;
  padding:1vh 2vw;
  text-align:center;
  font-size:1.3rem;
  font-weight:bold;
  box-shadow:0 3px 10px rgba(0,0,0,0.1);
  margin-top:1vh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  white-space: normal;
}

.question-box img{
  max-width:80vw; max-height:25vh; margin-top:1vh; border-radius:8px;
}

@keyframes shake {
  0%, 100% { transform: translate(0, 0); }
  20% { transform: translate(-5px, 0); }
  40% { transform: translate(5px, 0); }
  60% { transform: translate(-3px, 0); }
  80% { transform: translate(3px, 0); }
}

.question-box img.shake {
  animation: shake 0.2s ease;
}

.question-box span{
  display: inline;
  color:var(--color-light);
}

#tap-gauge {
  position: absolute;
  right: 20px;
  top: 35vh;
  transform: translateY(-50%);
  width: 15px;
  height: 25vh;
  background: #FFF;
  border: 3px solid var(--color-dark);
  border-radius: 0px;
}

#tap-count{
  color:var(--color-dark);
  position: absolute;
  top: -30px;
  width: 50px;
  text-align: center;
  font-size: 18px;
  right:-18px;
}

#tap-fill {
  position: absolute;
  bottom: -3px;
  left: -3px;
  width: 100%;
  height: 0%;
  background: #ff3b3b;
  border: 3px solid var(--color-dark);
  /* transition: height 0.1s linear; */
}

#sukaText {
  position: fixed;
  top: 35%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 2rem;
  color: #333;
  font-weight: bold;
  display: none;
  pointer-events: none;
  z-index: 1000;
}


/* === タイマー === */
.timer-container{
  flex:0.8;
  display:flex;
  align-items:center;
  justify-content:center;
  margin:0;
  gap:2vw;
}

.timer-label{
  color:var(--color-text);
  font-weight:bold;
  font-size:1rem;
  text-shadow:
    -2px -2px 0 var(--color-dark),
     2px -2px 0 var(--color-dark),
    -2px  2px 0 var(--color-dark),
     2px  2px 0 var(--color-dark),
    -2px  0   0 var(--color-dark),
     2px  0   0 var(--color-dark),
     0   -2px 0 var(--color-dark),
     0    2px 0 var(--color-dark);
}

.timer-bar {
  position: relative;
  width: 90%;
  height: 12px;
  background: var(--color-dark);
  border: 3px solid var(--color-dark);
  border-radius: 10px;
  overflow: hidden;
}

.timer-progress {
  position: absolute;
  height: 100%;
  width: 100%;
  background: var(--color-light);
  border-radius: 10px;
  transition: width 10s linear;
}

/* === ボタン === */
.buttons{
  flex: 1 1 auto;
  display:flex;
  height: 10vh;
  width: 100%;
  justify-content:space-between;
  align-items:stretch;
  gap:4vw;
  gap:15px;
  margin-bottom:1vh;
  flex-wrap: nowrap; /* 折り返さない */
}

.buttons.two-row {
  display: grid;
  grid-template-columns: repeat(2, 1fr); /* 2列 */
  grid-template-rows: repeat(2, 1fr);    /* 2行 */
  width: 100%;
  margin-bottom: 1vh;
}

.buttons.two-row button {
  font-size: clamp(1rem, 2rem, 2.5rem);
}

/* ボタン数に応じた幅調整 */
.buttons:has(button:nth-child(1):last-child) button {
  width: 60%;
}

.buttons:has(button:nth-child(2):last-child) button {
  width: 45%;
}

.buttons:has(button:nth-child(3):last-child) button {
  max-width: 30%;
  font-size: clamp(1rem, 1.2rem, 2.5rem);
}

.buttons:has(button:nth-child(4):last-child) button {
  /*width: 45%;*/
}

button{
  flex: 1;                /* 均等幅 */
  background:white;
  border:7px solid var(--color-dark);
  outline:3px solid white;
  border-radius:12px;
  font-weight:bold;
  box-shadow:0 12px var(--color-shadow);
  color:var(--color-dark);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  white-space: nowrap;     /* 改行を禁止 */
  text-overflow: ellipsis; /* はみ出しを防止 */
  font-size: clamp(1rem, 2.5rem, 3rem); /* ←自動スケール 最小、推奨、最大 */
}

button.three-word{
  font-size:2rem;
}

button.pressed{
  background:var(--color-dark);
  color:var(--color-text);
  transform:translateY(6px);
  box-shadow:0 2px #002f66;
  transition:all .1s ease;
}

.mikiri button{
  border:7px solid var(--color-mikiri);
  color:var(--color-mikiri);
  background-image: url("images/mikiri.png");
  background-size: contain;     /* 正方形画像の比率維持 */
  background-repeat: no-repeat;
  background-position: center;
}

.mikiri button.pressed{
  background:var(--color-mikiri);
  color:var(--color-text);
  background-image: url("images/mikiri_press.png");
  background-size: contain;     /* 正方形画像の比率維持 */
  background-repeat: no-repeat;
  background-position: center;
}

.renda button{
  border:7px solid var(--color-renda);
  color:var(--color-renda);
  background-image: url("images/renda.png");
  background-size: contain;     /* 正方形画像の比率維持 */
  background-repeat: no-repeat;
  background-position: center;
}

.renda button.pressed{
  background:#FFFFFF;
  color:var(--color-renda);
  background-image: url("images/renda.png");
  background-size: contain;     /* 正方形画像の比率維持 */
  background-repeat: no-repeat;
  background-position: center;
}

button img{
  max-width:60%; margin-top:0.5vh; border-radius:6px;
}

.banner{
  flex: 1;
}

/* === カットイン === */
.cutin {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size:2rem; 
  font-weight:bold;
  z-index: 9000;
  opacity: 0;
  pointer-events: none;
}

.cutin.active{
  opacity: 1;
  animation: 0.4s ease-out forwards;
}
.cutin.active .cutin::before{
  animation: redCircleExpand 0.4s ease-out forwards;
}
.cutin.active .cutin-content::before {
  animation: bandExpand 0.6s ease-out forwards;
}
.cutin.active .cutin-score {
  animation: scoreGlow 1.2s ease-out forwards;
}
.cutin.active #rankSvg {
  animation: popIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) both;
}
.cutin.active #countSvg {
  animation: redCircleExpand 0.4s ease-out forwards;
}


.cutin-content {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.cutin-content::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scaleX(0); /* ← 幅0から開始 */
  transform-origin: center; /* ← 中央から左右に広がる */
  width: 100vw;
  height: 110%; 
  background: linear-gradient(
    to right,
    transparent 0%,
    rgba(0, 0, 0, 0.4) 30%,  /* 中央付近で濃く */
    rgba(0, 0, 0, 0.4) 70%,
    transparent 100%
  );
  border-radius: 0.5em;
  z-index: -1;
  /* animation: bandExpand 0.6s ease-out forwards; */
}

@keyframes bandExpand {
  0% {
    transform: translate(-50%, -50%) scaleX(0);
    opacity: 0;
  }
  40% {
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scaleX(1);
    opacity: 1;
  }
}

/* カットイン〇×画像 */
.cutin-img {
  width:20vh; 
  height:20vh; 
  margin-top:1vh; 
  margin-bottom:0vh; 
  animation: redCircleExpand 0.4s ease-out forwards;
  z-index: -1;
}

@keyframes redCircleExpand {
  0% {
    transform: translate(0%, 0%) scale(0);
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translate(0%, 0%) scale(1);
    opacity: 1;
  }
}

/* 連打回数/見切り秒数 */
#countSvg {
  height:20vh; 
  margin-top:1vh; 
  margin-bottom:0vh; 
  animation: redCircleExpand 0.4s ease-out forwards;
  z-index: -1;
  font-size:4rem;
}

/* EXCELLENTのはねる動き */
#rankSvg {
  width: auto;
  height: 2rem;
  overflow: visible;
  display: block;
  margin-top:-1rem;
}

@keyframes popIn {
  0% {
    transform: scale(0.9);
    opacity: 0;
  }
  60% {
    transform: scale(1.2);
    opacity: 1;
  }
  100% {
    transform: scale(1);
  }
}

/* スコア発光 */
.cutin-score {
  position: relative;
  display: inline-block;
  padding: 0em 0em;
  
  font-size: 1.5rem;
  font-weight: bold;
  color: white;
  text-shadow:
    0 0 8px rgba(255,255,255,0.8),
    0 0 12px rgba(100,200,255,0.6);
  opacity: 0;
  /* animation: scoreGlow 1s ease-out 0.4s forwards; */
}

@keyframes scoreGlow {
  0% {
    opacity: 0;
    text-shadow: none;
  }
  50% {
    opacity: 1;
    text-shadow:
      0 0 25px rgba(255,255,255,1),
      0 0 60px rgba(120,220,255,1),
      0 0 90px rgba(150,240,255,0.9);
  }
  100% {
    opacity: 1;
    text-shadow:
      0 0 6px rgba(255,255,255,0.8),
      0 0 12px rgba(100,200,255,0.6);
  }
}

/* === カットイン終了アニメ === */
@keyframes cutinDisappear {
  0% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.2;
  }
  100% {
    opacity: 0;
    transform: scale(0.8);
  }
}


@keyframes bandDisappear {
  0% {
    transform: translate(-50%, -50%) scaleX(1);
    opacity: 1;
  }
  40% {
    opacity: 1;
  }
  100% {
    transform: translate(-50%, -50%) scaleX(0);
    opacity: 0;
  }
}

.cutin.disappear .cutin-content::before {
  animation: bandDisappear 0.5s ease-out forwards;
}
.cutin.disappear .cutin-score {
  animation: cutinDisappear 0.3s ease-out forwards;
}
.cutin.disappear #rankSvg {
  animation: cutinDisappear 0.3s ease-out forwards;
}
.cutin.disappear .cutin-img {
  animation: cutinDisappear 0.3s ease-out forwards;
}
.cutin.disappear #countSvg {
  animation: cutinDisappear 0.3s ease-out forwards;
}


/* === カウントダウン === */
#countdown-overlay{
  position:fixed;top:0;left:0;width:100%;height:100%;
  color:#fff;display:flex;
  align-items:center;
  justify-content:center;z-index:2000;
}
.count-number{
  color:#FFF;
  font-size:5rem;font-weight:bold;margin-bottom:10vh;
  opacity: 0;
}
.buttons .count-number{
  width:100%;
  text-align: center;
}
@keyframes moveUp{
  0%{transform:translateY(100%);opacity:0}
  30%{transform:translateY(0);opacity:1}
  70%{transform:translateY(0);opacity:1}
  100%{transform:translateY(-100%);opacity:0}
}

/* === ローディング画面 === */
#loading-overlay{
  position:fixed;top:0;left:0;width:100%;height:100%;
  /*background:#333;*/
  color:white;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  z-index:2500;
}
.loading-bar{
  width:60%;height:10px;
  border: 3px solid var(--color-dark);
  background:var(--color-dark);
  border-radius:10px;
  overflow:hidden;margin-top:1rem;
}
.loading-progress{
  width:0%;height:100%;
  background:var(--color-light);
  border-radius:10px;
  transition:width 3s linear;
}

/* === ステージ移行画面 === */
#stage-overlay{
  position:fixed;top:0;left:0;width:100%;height:100%;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  z-index:3000;
  color:white;
}

#stage-overlay-title,
#stage-overlay-loading {
  display: flex;
  flex-direction: column;   /* 縦に並べる */
  justify-content: center;  /* 縦中央 */
  align-items: center;      /* 横中央 */
  text-align: center;       /* テキスト中央寄せ */
  width: 100%;
  height: 100%;
}

#stage-title{
  font-size:2rem;
  font-weight:bold;
  margin-bottom:2vh;
  color:white;
  text-align:center;
  text-shadow:
    -3px -3px 0 var(--color-dark),
     0   -3px 0 var(--color-dark),
     3px -3px 0 var(--color-dark),
    -3px  0   0 var(--color-dark),
     3px  0   0 var(--color-dark),
    -3px  3px 0 var(--color-dark),
     0    3px 0 var(--color-dark),
     3px  3px 0 var(--color-dark),
    -2px -2px 0 var(--color-dark),
     2px -2px 0 var(--color-dark),
    -2px  2px 0 var(--color-dark),
     2px  2px 0 var(--color-dark);
}

#stage-msg,
#loading-msg{
  font-weight:bold;
}
